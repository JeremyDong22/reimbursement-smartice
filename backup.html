<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense Reimbursement Report</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #0f0f0f;
            color: #e0e0e0;
            min-height: 100vh;
            padding: 40px 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: #1a1a1a;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5), 0 0 100px rgba(66, 68, 90, 0.1);
            border: 1px solid #2a2a2a;
        }
        
        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,%3Csvg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23ffffff" fill-opacity="0.03"%3E%3Cpath d="M0 40L40 0H20L0 20M40 40V20L20 40"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');
        }
        
        h1 {
            color: #ffffff;
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 10px;
            position: relative;
            letter-spacing: -0.5px;
        }
        
        .subtitle {
            color: rgba(255, 255, 255, 0.9);
            font-size: 16px;
            position: relative;
        }
        
        .report-info {
            background: #242424;
            padding: 25px 40px;
            border-bottom: 1px solid #2a2a2a;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .info-item {
            display: flex;
            flex-direction: column;
        }
        
        .info-label {
            color: #888;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }
        
        .info-value {
            color: #fff;
            font-size: 16px;
            font-weight: 600;
        }
        
        .docs-link {
            background: linear-gradient(135deg, #4285f4, #34a853);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .docs-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(66, 133, 244, 0.3);
        }
        
        .table-container {
            padding: 30px;
            background: #1a1a1a;
        }
        
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }
        
        th {
            background: #2a2a2a;
            color: #fff;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 2px solid #3a3a3a;
        }
        
        td {
            padding: 12px 15px;
            border-bottom: 1px solid #2a2a2a;
            color: #d0d0d0;
        }
        
        tr:hover:not(.category-header):not(.subtotal):not(.grand-total) {
            background: #242424;
        }
        
        .category-header td {
            background: #242424;
            color: #fff;
            font-weight: 600;
            font-size: 15px;
            padding: 15px;
            border-left: 3px solid #4a9eff;
        }
        
        .subtotal td {
            background: #1f2937;
            color: #60a5fa;
            font-weight: 600;
            border-top: 1px solid #3a3a3a;
        }
        
        .grand-total td {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: #fff;
            font-weight: 700;
            font-size: 18px;
            padding: 20px 15px;
            border: none;
        }
        
        .amount {
            text-align: right;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
            font-weight: 500;
        }
        
        .usd {
            color: #4ade80;
        }
        
        .rmb {
            color: #fbbf24;
        }
        
        .converted {
            color: #a78bfa;
        }
        
        .summary-section {
            background: #242424;
            padding: 30px;
            border-top: 1px solid #2a2a2a;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .summary-card {
            background: #1a1a1a;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #2a2a2a;
            transition: transform 0.2s;
        }
        
        .summary-card:hover {
            transform: translateY(-2px);
            border-color: #3a3a3a;
        }
        
        .summary-label {
            color: #888;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }
        
        .summary-value {
            color: #fff;
            font-size: 24px;
            font-weight: 700;
        }
        
        .total-card {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            grid-column: 1 / -1;
            text-align: center;
            padding: 30px;
        }
        
        .total-card .summary-label {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
        }
        
        .total-card .summary-value {
            font-size: 36px;
            color: #fff;
        }
        
        .footer {
            background: #1a1a1a;
            padding: 20px 30px;
            text-align: center;
            border-top: 1px solid #2a2a2a;
        }
        
        .download-btn {
            background: linear-gradient(135deg, #4ade80, #22c55e);
            color: #fff;
            border: none;
            padding: 12px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(74, 222, 128, 0.3);
        }
        
        .badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-left: 10px;
        }
        
        .badge-pending {
            background: #fbbf24;
            color: #000;
        }
        
        @media (max-width: 768px) {
            .report-info {
                padding: 20px;
            }
            
            .table-container {
                padding: 15px;
                overflow-x: auto;
            }
            
            table {
                min-width: 500px;
            }
        }
        
        @media print {
            body {
                background: white;
                color: black;
            }
            
            .container {
                box-shadow: none;
                border: 1px solid #ddd;
            }
            
            .header {
                background: #f0f0f0;
                color: #333;
            }
            
            h1, .subtitle {
                color: #333;
            }
            
            .download-btn, .docs-link {
                display: none;
            }
            
            .category-header td, .report-info, .summary-section, .footer {
                background: #f5f5f5;
            }
            
            td, .info-value, .summary-value {
                color: #333;
            }
            
            .info-label, .summary-label {
                color: #666;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>💼 Expense Reimbursement Report</h1>
            <div class="subtitle">Professional Services & Operations</div>
        </div>
        
        <div class="report-info">
            <div class="info-item">
                <span class="info-label">Report Date</span>
                <span class="info-value">August 28, 2025</span>
            </div>
            <div class="info-item">
                <span class="info-label">Exchange Rate</span>
                <span class="info-value">1 USD = 7.179186 CNY</span>
            </div>
            <div class="info-item">
                <span class="info-label">Status</span>
                <span class="info-value">Pending Review <span class="badge badge-pending">PENDING</span></span>
            </div>
            <div class="info-item">
                <a href="https://docs.google.com/document/d/1sJIOjPmnCAz4bHTANF4dri0wcEPPnKnqw6oJzSVRzjU/edit?tab=t.0" target="_blank" class="docs-link">
                    📄 View Supporting Documents
                </a>
            </div>
        </div>
        
        <div class="table-container">
            <table id="expenseTable">
                <thead>
                    <tr>
                        <th style="width: 40%;">Category / Description</th>
                        <th style="width: 20%;">Original Amount</th>
                        <th style="width: 20%;">Currency</th>
                        <th style="width: 20%;">RMB Value</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- 机票交通 -->
                    <tr class="category-header">
                        <td colspan="4">✈️ Airline Tickets & Primary Transportation (机票交通)</td>
                    </tr>
                    <tr><td>Business Travel - Flight 1</td><td class="amount">918.00</td><td>RMB</td><td class="amount rmb">918.00</td></tr>
                    <tr><td>Business Travel - Flight 2</td><td class="amount">892.00</td><td>RMB</td><td class="amount rmb">892.00</td></tr>
                    <tr><td>Business Travel - Flight 3</td><td class="amount">877.00</td><td>RMB</td><td class="amount rmb">877.00</td></tr>
                    <tr><td>Business Travel - Flight 4</td><td class="amount">581.00</td><td>RMB</td><td class="amount rmb">581.00</td></tr>
                    <tr><td>Business Travel - Flight 5</td><td class="amount">1,300.00</td><td>RMB</td><td class="amount rmb">1,300.00</td></tr>
                    <tr><td>Business Travel - Flight 6</td><td class="amount">933.00</td><td>RMB</td><td class="amount rmb">933.00</td></tr>
                    <tr><td>Business Travel - Flight 7</td><td class="amount">1,126.00</td><td>RMB</td><td class="amount rmb">1,126.00</td></tr>
                    <tr class="subtotal">
                        <td colspan="3">Category Subtotal</td>
                        <td class="amount">6,627.00</td>
                    </tr>

                    <!-- 交通 -->
                    <tr class="category-header">
                        <td colspan="4">🚗 Local Transportation (交通)</td>
                    </tr>
                    <tr><td>Ground Transport - Trip 1</td><td class="amount">80.90</td><td>RMB</td><td class="amount rmb">80.90</td></tr>
                    <tr><td>Ground Transport - Trip 2</td><td class="amount">6.60</td><td>RMB</td><td class="amount rmb">6.60</td></tr>
                    <tr><td>Ground Transport - Trip 3</td><td class="amount">104.20</td><td>RMB</td><td class="amount rmb">104.20</td></tr>
                    <tr><td>Ground Transport - Trip 4</td><td class="amount">20.10</td><td>RMB</td><td class="amount rmb">20.10</td></tr>
                    <tr><td>Ground Transport - Trip 5</td><td class="amount">13.70</td><td>RMB</td><td class="amount rmb">13.70</td></tr>
                    <tr><td>Ground Transport - Trip 6</td><td class="amount">5.20</td><td>RMB</td><td class="amount rmb">5.20</td></tr>
                    <tr><td>Ground Transport - Trip 7</td><td class="amount">122.57</td><td>RMB</td><td class="amount rmb">122.57</td></tr>
                    <tr class="subtotal">
                        <td colspan="3">Category Subtotal</td>
                        <td class="amount">353.27</td>
                    </tr>

                    <!-- Claude Code -->
                    <tr class="category-header">
                        <td colspan="4">💻 AI Development Tools - Claude Code</td>
                    </tr>
                    <tr><td>Claude Pro Subscription - Q1</td><td class="amount usd">200.00</td><td>USD</td><td class="amount converted">1,435.84</td></tr>
                    <tr><td>Claude API Credits</td><td class="amount usd">113.68</td><td>USD</td><td class="amount converted">816.14</td></tr>
                    <tr><td>Claude Team License</td><td class="amount usd">82.00</td><td>USD</td><td class="amount converted">588.69</td></tr>
                    <tr><td>Additional API Usage</td><td class="amount usd">20.00</td><td>USD</td><td class="amount converted">143.58</td></tr>
                    <tr class="subtotal">
                        <td colspan="3">Category Subtotal (415.68 USD)</td>
                        <td class="amount">2,984.25</td>
                    </tr>

                    <!-- Wispr Flow -->
                    <tr class="category-header">
                        <td colspan="4">🌊 Workflow Automation - Wispr Flow</td>
                    </tr>
                    <tr><td>Wispr Flow License - Month 1</td><td class="amount usd">15.00</td><td>USD</td><td class="amount converted">107.69</td></tr>
                    <tr><td>Wispr Flow License - Month 2</td><td class="amount usd">15.00</td><td>USD</td><td class="amount converted">107.69</td></tr>
                    <tr class="subtotal">
                        <td colspan="3">Category Subtotal (30.00 USD)</td>
                        <td class="amount">215.38</td>
                    </tr>

                    <!-- Supabase -->
                    <tr class="category-header">
                        <td colspan="4">🗄️ Database Infrastructure - Supabase</td>
                    </tr>
                    <tr><td>Supabase Pro - January</td><td class="amount usd">25.00</td><td>USD</td><td class="amount converted">179.48</td></tr>
                    <tr><td>Supabase Pro - February</td><td class="amount usd">25.00</td><td>USD</td><td class="amount converted">179.48</td></tr>
                    <tr><td>Supabase Pro - March</td><td class="amount usd">25.00</td><td>USD</td><td class="amount converted">179.48</td></tr>
                    <tr><td>Supabase Pro - April</td><td class="amount usd">25.00</td><td>USD</td><td class="amount converted">179.48</td></tr>
                    <tr><td>Supabase Pro - May</td><td class="amount usd">25.00</td><td>USD</td><td class="amount converted">179.48</td></tr>
                    <tr class="subtotal">
                        <td colspan="3">Category Subtotal (125.00 USD)</td>
                        <td class="amount">897.40</td>
                    </tr>

                    <!-- VPN -->
                    <tr class="category-header">
                        <td colspan="4">🔒 Security Services - VPN</td>
                    </tr>
                    <tr><td>VPN Service - Primary</td><td class="amount">59.00</td><td>RMB</td><td class="amount rmb">59.00</td></tr>
                    <tr><td>VPN Service - Backup</td><td class="amount">10.00</td><td>RMB</td><td class="amount rmb">10.00</td></tr>
                    <tr><td>VPN Premium Features</td><td class="amount">68.80</td><td>RMB</td><td class="amount rmb">68.80</td></tr>
                    <tr class="subtotal">
                        <td colspan="3">Category Subtotal</td>
                        <td class="amount">137.80</td>
                    </tr>

                    <!-- Cursor -->
                    <tr class="category-header">
                        <td colspan="4">⌨️ Code Editor - Cursor IDE</td>
                    </tr>
                    <tr><td>Cursor Pro - Month 1</td><td class="amount usd">20.00</td><td>USD</td><td class="amount converted">143.58</td></tr>
                    <tr><td>Cursor Pro - Month 2</td><td class="amount usd">20.00</td><td>USD</td><td class="amount converted">143.58</td></tr>
                    <tr><td>Cursor Pro - Month 3</td><td class="amount usd">20.00</td><td>USD</td><td class="amount converted">143.58</td></tr>
                    <tr><td>API Usage Overage</td><td class="amount usd">0.62</td><td>USD</td><td class="amount converted">4.45</td></tr>
                    <tr><td>Additional Credits</td><td class="amount usd">17.92</td><td>USD</td><td class="amount converted">128.65</td></tr>
                    <tr><td>Extra Features</td><td class="amount usd">10.00</td><td>USD</td><td class="amount converted">71.79</td></tr>
                    <tr class="subtotal">
                        <td colspan="3">Category Subtotal (88.54 USD)</td>
                        <td class="amount">635.63</td>
                    </tr>

                    <!-- Open Router -->
                    <tr class="category-header">
                        <td colspan="4">🌐 API Gateway - Open Router</td>
                    </tr>
                    <tr><td>API Usage - Tier 1</td><td class="amount usd">2.09</td><td>USD</td><td class="amount converted">15.00</td></tr>
                    <tr><td>API Usage - Tier 2</td><td class="amount usd">6.00</td><td>USD</td><td class="amount converted">43.08</td></tr>
                    <tr><td>API Usage - Tier 3</td><td class="amount usd">5.00</td><td>USD</td><td class="amount converted">35.90</td></tr>
                    <tr class="subtotal">
                        <td colspan="3">Category Subtotal (13.09 USD)</td>
                        <td class="amount">93.98</td>
                    </tr>

                    <!-- 其他 -->
                    <tr class="category-header">
                        <td colspan="4">📦 Equipment & Other (其他)</td>
                    </tr>
                    <tr><td>Webcam for Remote Meetings</td><td class="amount">145.00</td><td>RMB</td><td class="amount rmb">145.00</td></tr>
                    <tr class="subtotal">
                        <td colspan="3">Category Subtotal</td>
                        <td class="amount">145.00</td>
                    </tr>

                    <!-- Grand Total -->
                    <tr class="grand-total">
                        <td colspan="3">TOTAL REIMBURSEMENT AMOUNT</td>
                        <td class="amount" style="font-size: 22px;">¥12,089.69</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="summary-section">
            <div class="summary-grid">
                <div class="summary-card">
                    <div class="summary-label">Direct RMB Expenses</div>
                    <div class="summary-value">¥7,263.07</div>
                </div>
                <div class="summary-card">
                    <div class="summary-label">USD Expenses</div>
                    <div class="summary-value">$672.31</div>
                </div>
                <div class="summary-card">
                    <div class="summary-label">USD → RMB Converted</div>
                    <div class="summary-value">¥4,826.62</div>
                </div>
                <div class="total-card summary-card">
                    <div class="summary-label">Total Reimbursement Required</div>
                    <div class="summary-value">¥12,089.69</div>
                </div>
            </div>
        </div>

        <div class="footer">
            <button class="download-btn" onclick="downloadAsExcel()">
                📊 Download Excel Report
            </button>
        </div>
    </div>

    <script>
        function downloadAsExcel() {
            // Create CSV content with proper formatting
            let csvContent = "\uFEFF"; // BOM for Excel UTF-8 recognition
            csvContent += "EXPENSE REIMBURSEMENT REPORT\n";
            csvContent += "Report Date: August 28, 2025\n";
            csvContent += "Exchange Rate: 1 USD = 7.179186 CNY\n";
            csvContent += "Supporting Documents: https://docs.google.com/document/d/1sJIOjPmnCAz4bHTANF4dri0wcEPPnKnqw6oJzSVRzjU/edit?tab=t.0\n\n";
            
            csvContent += "Category,Description,Original Amount,Currency,RMB Value\n";
            
            // Business expenses data
            const expenses = [
                ["AIRLINE TICKETS & PRIMARY TRANSPORTATION"],
                ["","Business Travel - Flight 1","918.00","RMB","918.00"],
                ["","Business Travel - Flight 2","892.00","RMB","892.00"],
                ["","Business Travel - Flight 3","877.00","RMB","877.00"],
                ["","Business Travel - Flight 4","581.00","RMB","581.00"],
                ["","Business Travel - Flight 5","1300.00","RMB","1300.00"],
                ["","Business Travel - Flight 6","933.00","RMB","933.00"],
                ["","Business Travel - Flight 7","1126.00","RMB","1126.00"],
                ["","Subtotal","","","6627.00"],
                [""],
                ["LOCAL TRANSPORTATION"],
                ["","Ground Transport - Trip 1","80.90","RMB","80.90"],
                ["","Ground Transport - Trip 2","6.60","RMB","6.60"],
                ["","Ground Transport - Trip 3","104.20","RMB","104.20"],
                ["","Ground Transport - Trip 4","20.10","RMB","20.10"],
                ["","Ground Transport - Trip 5","13.70","RMB","13.70"],
                ["","Ground Transport - Trip 6","5.20","RMB","5.20"],
                ["","Ground Transport - Trip 7","122.57","RMB","122.57"],
                ["","Subtotal","","","353.27"],
                [""],
                ["AI DEVELOPMENT TOOLS - CLAUDE CODE"],
                ["","Claude Pro Subscription - Q1","200.00","USD","1435.84"],
                ["","Claude API Credits","113.68","USD","816.14"],
                ["","Claude Team License","82.00","USD","588.69"],
                ["","Additional API Usage","20.00","USD","143.58"],
                ["","Subtotal (415.68 USD)","","","2984.25"],
                [""],
                ["WORKFLOW AUTOMATION - WISPR FLOW"],
                ["","Wispr Flow License - Month 1","15.00","USD","107.69"],
                ["","Wispr Flow License - Month 2","15.00","USD","107.69"],
                ["","Subtotal (30.00 USD)","","","215.38"],
                [""],
                ["DATABASE INFRASTRUCTURE - SUPABASE"],
                ["","Supabase Pro - January","25.00","USD","179.48"],
                ["","Supabase Pro - February","25.00","USD","179.48"],
                ["","Supabase Pro - March","25.00","USD","179.48"],
                ["","Supabase Pro - April","25.00","USD","179.48"],
                ["","Supabase Pro - May","25.00","USD","179.48"],
                ["","Subtotal (125.00 USD)","","","897.40"],
                [""],
                ["SECURITY SERVICES - VPN"],
                ["","VPN Service - Primary","59.00","RMB","59.00"],
                ["","VPN Service - Backup","10.00","RMB","10.00"],
                ["","VPN Premium Features","68.80","RMB","68.80"],
                ["","Subtotal","","","137.80"],
                [""],
                ["CODE EDITOR - CURSOR IDE"],
                ["","Cursor Pro - Month 1","20.00","USD","143.58"],
                ["","Cursor Pro - Month 2","20.00","USD","143.58"],
                ["","Cursor Pro - Month 3","20.00","USD","143.58"],
                ["","API Usage Overage","0.62","USD","4.45"],
                ["","Additional Credits","17.92","USD","128.65"],
                ["","Extra Features","10.00","USD","71.79"],
                ["","Subtotal (88.54 USD)","","","635.63"],
                [""],
                ["API GATEWAY - OPEN ROUTER"],
                ["","API Usage - Tier 1","2.09","USD","15.00"],
                ["","API Usage - Tier 2","6.00","USD","43.08"],
                ["","API Usage - Tier 3","5.00","USD","35.90"],
                ["","Subtotal (13.09 USD)","","","93.98"],
                [""],
                ["EQUIPMENT & OTHER"],
                ["","Webcam for Remote Meetings","145.00","RMB","145.00"],
                ["","Subtotal","","","145.00"],
                [""],
                [""],
                ["SUMMARY","","",""],
                ["Direct RMB Expenses","","","","7263.07"],
                ["USD Expenses","","","","672.31"],
                ["USD Converted to RMB","","","","4826.62"],
                ["TOTAL REIMBURSEMENT AMOUNT","","","","12089.69"]
            ];
            
            expenses.forEach(row => {
                csvContent += row.join(',') + '\n';
            });
            
            // Create download link
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', 'expense_reimbursement_report.csv');
            link.style.display = 'none';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html>